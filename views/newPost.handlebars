<div class="container">
    <div class="row justify-content-md-center">
        <div class="col-8 ">
            <div class="row justify-content-md-center">
                <h1 class="col-6">New Post view</h1>
            </div>
            <form>
                <div class="form-group">
                    <label for="title">Title</label>
                    <input type="text" class="form-control" id="title" placeholder="Title">
                </div>
                <div class="form-group">
                    <label for="title">Slug</label>
                    <input type="text" class="form-control" id="slug" placeholder="lorem-ipsum">
                </div>
                <div class="form-group">
                    <label for="content">Content</label>
                    <textarea class="form-control" id="content" rows="3"></textarea>
                </div>
            </form>
            <div class="container">
                <div class="row">
                    <button onclick="discard()">Discard</button>
                    <button onclick="submit()">Publish</button>
                </div>
                <div>{{#if error}}{{error}}{{/if}}</div>
                <div class="row" style="color: red;" id="errorMsg"></div>
            </div>



        </div>
    </div>
</div>

<script>

    function discard() {
        window.location.pathname = '/admin'
    }

    function submit() {
        let title = document.getElementById('title').value
        let content = document.getElementById('content').value
        let slug = document.getElementById('slug').value
        console.log(title, content)

        if (formCheck(title, content, slug)) {
            fetch(('/newPost'), {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ title: title, content: content, slug:slug })
            }).then(res => window.location = res.url)
        }

    }

    function formCheck(title, content, slug) {
        let errorMessage = document.getElementById('errorMsg')
        errorMessage.innerText = ''
        if (!title || !slug || !content) {
            if (!title) {
                errorMessage.innerText = 'Title '
            }

            if (!slug) {
                if (errorMessage.innerText) {
                    errorMessage.innerText += ' and slug '
                } else {
                    errorMessage.innerText = 'Slug'
                }
            }

            if (!content) {
                if (errorMessage.innerText) {
                    errorMessage.innerText += ' and content '
                } else {
                    errorMessage.innerText = 'Content'
                }
            }

            if (1) {
                errorMessage.innerText += ' are required '
            } else {
                errorMessage.innerText += 'is required'


            }
            return false
        }
        return true
    }
</script>